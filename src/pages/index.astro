---
import { getCollection } from 'astro:content'
import DefaultLayout from '../layouts/DefaultLayout.astro'
import Hero from '../components/Hero.astro'
import Feature from '../components/Feature.astro'
import SectionContainer from '../components/SectionContainer.astro'
import HandoutItem from '../components/HandoutItem.astro'

interface IScheduleItem {
  content: string
  time: string
  note: string
}

const schedules: [string, IScheduleItem[]][] = [
  [
    'Web åŸºç¡€',
    [
      { content: 'HTML & CSS åŸºç¡€', time: 'April 3rd', note: 'ğŸŸ¢' },
      { content: 'ç½‘ç«™éƒ¨ç½²å®è·µ', time: 'April 13th', note: 'ğŸŸ¢' },
    ],
  ],
  [
    'JS å‰ç«¯æ¡†æ¶',
    [
      { content: 'Javascript è¯­æ³•åŸºç¡€åŠ DOM æ“ä½œ', time: 'April 24th', note: 'ğŸŸ¢' },
      { content: 'Vue.js åŸºç¡€', time: 'May 18th', note: 'ğŸ‘‹å¥½ä¹…ä¸è§ï¼' },
    ],
  ],
  [
    'åç«¯åº”ç”¨å¼€å‘',
    [
      { content: 'åç«¯åŸºæœ¬ç»„ä»¶åŠ Django åŸºç¡€ I', time: 'May 25th', note: 'ğŸŸ¢' },
      { content: 'Django åŸºç¡€ II', time: 'June 1st', note: 'ğŸŸ¢' },
    ],
  ],
  [
    'å‘¨è¾¹å•†åŸé¡¹ç›®',
    [
      { content: 'å•†å“æ¦‚è§ˆé¡µã€è´­ç‰©è½¦é¡µé¢å¼€å‘', time: 'May 29th', note: 'ğŸŸ¢' },
      { content: 'åç«¯å¼€å‘åŠ API æ¥å…¥', time: 'June 5th', note: '' },
    ],
  ],
]

const handoutCollection = await getCollection('handout')
const chapterCollection = await getCollection('chapter')
const tagCollection = await getCollection('tag')
---

<DefaultLayout title="">
  <Hero />

  <SectionContainer title="è¯¾ç¨‹å†…å®¹" id="features">
    <div class="grid grid-cols-1 gap-12 md:grid-cols-2 lg:grid-cols-3">
      <Feature icon="mdi:language-html5" title="Web åŸºç¡€">ç”¨ HTML å’Œ CSS æ­å»ºç‚«é…·çš„ç½‘é¡µï¼Œä½ ä¹Ÿå¯ä»¥ï¼</Feature>
      <Feature icon="mdi:vuejs" title="JS å‰ç«¯æ¡†æ¶">å“å“ï¼Œä½ è¿™ç½‘é¡µæ€ä¹ˆä¼šåŠ¨ï¼ä¸€èµ·é£å‘å‰ç«¯çš„å¤§å‘ï¼</Feature>
      <Feature icon="mdi:server-network-outline" title="åç«¯åº”ç”¨å¼€å‘">
        å¥½çœ‹çš„å‰ç«¯èƒŒåæœªå¿…æ˜¯æœ‰è¶£çš„çµé­‚ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯å‡¶çŒ›çš„èŸ’è›‡ï¼é«˜å¹¶å‘ã€åˆ†å¸ƒå¼...çœŸæ­£çš„è€ƒéªŒæ‰åˆšåˆšå¼€å§‹...
      </Feature>
    </div>
  </SectionContainer>

  <SectionContainer title="è¯¾ç¨‹å¤§çº²" id="syllabus">
    <div class="rounded-lg dark:bg-neutral-800 dark:text-neutral-200">
      <table class="table-auto border-collapse rounded-lg bg-neutral-100 dark:bg-neutral-800">
        <thead class="text-left text-lg text-neutral-700 dark:text-neutral-200">
          <tr>
            {
              ['ç« èŠ‚', 'å†…å®¹', 'æ—¶é—´', 'å¤‡æ³¨'].map((item) => (
                <th class="border-b p-4 pb-3 font-bold dark:border-neutral-600 lg:p-6">{item}</th>
              ))
            }
          </tr>
        </thead>

        <tbody>
          {
            schedules.map(([chapter, chapterSchedules], chIndex) =>
              chapterSchedules.map(({ content, time, note }, index) => (
                <tr
                  class={`${
                    index === chapterSchedules.length - 1 &&
                    chIndex !== schedules.length - 1 &&
                    'border-b border-b-neutral-200 dark:border-b-neutral-700'
                  }`}
                >
                  {index === 0 && (
                    <td class="p-4 lg:p-6" rowspan={chapterSchedules.length}>
                      {chapter}
                    </td>
                  )}
                  <td class="p-4 lg:p-6">{content}</td>
                  <td class="p-4 lg:p-6">{time || 'å¾…å®š'}</td>
                  <td class="p-4 lg:p-6">{note || 'æ— '}</td>
                </tr>
              ))
            )
          }
        </tbody>
      </table>
    </div>
  </SectionContainer>

  <SectionContainer title="è¯¾ç¨‹æ–‡æ¡£" id="handouts">
    <div>
      {
        chapterCollection.map((chapter) => (
          <>
            <h3 class="mb-8 mt-14 text-5xl">{chapter.data.name}</h3>
            <div class="grid grid-cols-1 gap-12 md:grid-cols-2 lg:grid-cols-3">
              {handoutCollection
                .filter((item) => item.data.chapter.id === chapter.id)
                .map((handout) => (
                  <HandoutItem
                    icon={handout.data.icon}
                    title={handout.data.title}
                    thumbnail={handout.data.thumbnail}
                    href={`/handouts/${chapterCollection.find((ch) => ch.id === handout.data.chapter.id)!.data.slug}/${
                      handout.slug
                    }`}
                    tags={handout.data.tags?.map((item) => tagCollection.find((tag) => tag.id === item.id)) || []}
                  >
                    {handout.data.description}
                  </HandoutItem>
                ))}
            </div>
          </>
        ))
      }
    </div>
  </SectionContainer>
</DefaultLayout>
